<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Curliceu | Jewelry You Draw</title>
    <link rel="stylesheet" href="css/foundation.css" />
    <link rel="stylesheet" href="css/app.css" />
    <link type="text/css" id="snipcart-theme" href="https://app.snipcart.com/themes/base/snipcart.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Rochester' rel='stylesheet' type='text/css'>
    <script src="js/vendor/modernizr.js"></script>
  </head>
  <body>
   <div class="row"> 
      <div class="large-12 columns">
        <h1><span id="title">Curliceu</span><span id="tm">&#0153;</tm></span> <small>Jewelry You Draw</small></h1>
      </div>
    </div>
    
    <div class="row" >
       <div class="large-12 columns" id="pic" style="display:none;">
      </div> 
      <div class="large-12 columns panel" id="drawPane">
        <h4><small>Write or draw something below!</small></h4>
        <div id="signature" style="border: solid 1px #ccc"></div>
      </div>
      <div class="large-4 medium-4 small-4 columns" style="text-align:center">      
      <a href="javascript:void();" class="tiny round button" id="reset">Reset</a>
      </div>
      <div class="large-4 medium-4 small-4 columns" style="text-align:center">  
      <a href="#" class="tiny round button" id="preview">Preview</a>
      </div>
      <div class="large-4 medium-4 small-4 columns" style="text-align:center">
        <a href="#" class="tiny round button snipcart-add-item" 
                    data-item-id="2" 
                    data-item-name="Custom Necklace" 
                    data-item-price="25.00" 
                    data-item-weight="20" 
                    data-item-url="http://curlic.eu" 
                    data-item-description="Custom Necklace"
                    id="buy">Buy It!</a>
      </div>
    </div>
    </div>
    <div class="row" id="output" style="display:none">
      <div class="large-12 columns">
        <textarea rows="10" id="svg"></textarea>
      </div>
     
   </div>
    <div class="row">
      <div class="large-12 columns">
       <h2>Examples</h2> 
      </div>
    </div>
    <div class="row">
      <div class="large-4 medium-6 columns photo">
        <img src="http://www.silverpromo.com/bmz_cache/8/89020fff0c845deedc915b52d52af372.image.300x300.jpg">
      </div>
      <div class="large-4 medium-6 columns photo">
        <img src="http://www.silverpromo.com/bmz_cache/8/89020fff0c845deedc915b52d52af372.image.300x300.jpg">
      </div>
      <div class="large-4 medium-6 columns photo">
        <img src="http://www.silverpromo.com/bmz_cache/8/89020fff0c845deedc915b52d52af372.image.300x300.jpg">
      </div>
      <div class="large-4 medium-6 columns photo">
        <img src="http://www.silverpromo.com/bmz_cache/8/89020fff0c845deedc915b52d52af372.image.300x300.jpg">
      </div>
      <div class="large-4 medium-6 columns photo">
        <img src="http://www.silverpromo.com/bmz_cache/8/89020fff0c845deedc915b52d52af372.image.300x300.jpg">
      </div>
      <div class="large-4 medium-6 columns photo">
        <img src="http://www.silverpromo.com/bmz_cache/8/89020fff0c845deedc915b52d52af372.image.300x300.jpg">
      </div>
    </div>

    <div class="row"> 
      <div class="large-12 columns" style="border-top: 1px solid #999;">
         <h6><small>&copy;2014 Valley View Customs</small></h6>
        <div class="large-4 medium-4 small-4 columns" style="text-align:center">
          <a href="#">About Us</a> 
        </div>
        <div class="large-4 medium-4 small-4 columns" style="text-align:center">
          <a href="#">FAQ</a>
        </div>
        <div class="large-4 medium-4 small-4 columns" style="text-align:center">
          <a href="#">Contact</a>
        </div>
      </div>
    </div>
    <script src="js/vendor/jquery.js"></script>
    <script type="text/javascript" id="snipcart" 
            src="https://app.snipcart.com/scripts/snipcart.js"
            data-api-key="OTBmZTVjYTgtZGMxMy00NzFmLTk1ODEtNDc3ZTdjOTMxMjU2"></script>
    <script src="js/foundation.min.js"></script>
	<!--[if lt IE 9]>
	<script type="text/javascript" src="js/vendor/flashcanvas.js"></script>
	<![endif]-->
	<script src="js/vendor/jSignature.min.js"></script>
    <script src="js/app.js"></script>
    <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
    <script>
      $(document).foundation();
      $(document).ready(function() {
	var $sigArea = $("#signature").jSignature({UndoButton:false});
        $("#reset").click(function() {
          $sigArea.jSignature('reset');
          $("#output").hide();
          $("#drawPane").show();
          $("#preview").show();
          $("#pic").hide();
        });
        $("#preview").click(function() {

          var datapair = $sigArea.jSignature("getData", "svg");  
          $("#svg").val(datapair[1]);
          $("#output").show();
          $("#drawPane").hide();
          $("#preview").hide();
          var img = new Image();
          var src = "data:" + datapair[0] + "," + datapair[1];

          var svg = $.parseXML( datapair[1] );
          console.log(datapair[1] );
          var height = parseInt($(svg).find("svg").attr('height'));
          var width = parseInt($(svg).find("svg").attr('width'));

          var path = $(svg).find("path");
          $(path).attr("transform","translate(20,20)");
          $(path).attr("stroke-opacity",".5");
          $(path).attr('stroke','#00FF00');
          $(path).attr('stroke-width','8');
          $(svg).find("svg").attr('width',width+40);
          $(svg).find("svg").attr('height',height+40);
          var src = "data:" + datapair[0] + "," + xmlToString(svg);;
          img.src = src;
          console.log(xmlToString(svg));
          $("#pic").html(img);
          $("#pic").show();

        });
        
      });

function xmlToString(xmlData) { 

    var xmlString;
    //IE
    if (window.ActiveXObject){
        xmlString = xmlData.xml;
    }
    // code for Mozilla, Firefox, Opera, etc.
    else{
        xmlString = (new XMLSerializer()).serializeToString(xmlData);
    }
    return xmlString;
} 
    </script>
  </body>
</html>
